{% paginate blog.articles by section.settings.articles_per_page %}

{% if section.settings.show_breadcrumbs %}
  {% render 'breadcrumbs', breadcrumb_type: 'blog' %}
{% endif %}
<div class="blog-section">
  <div class="blog-header">
    <h1 class="blog-title">{{ blog.title }}</h1>

    {% if section.settings.show_tags and blog.all_tags.size > 0 %}
      <div class="blog-tags">
        {% if current_tags %}
          <a href="{{ blog.url }}" class="blog-tag-pill">{{ 'blog.all_tags' | t }}</a>
        {% else %}
          <a href="{{ blog.url }}" class="blog-tag-pill active">{{ 'blog.all_tags' | t }}</a>
        {% endif %}
        {% for tag in blog.all_tags %}
          {% if current_tags contains tag %}
            <a href="{{ blog.url }}" class="blog-tag-pill active">{{ tag }}</a>
          {% else %}
            <a href="{{ blog.url }}/tagged/{{ tag | handleize }}" class="blog-tag-pill">{{ tag }}</a>
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}
  </div>

  {% if blog.articles.size > 0 %}
    <div class="blog-grid">
      {% for article in blog.articles %}
        <article class="blog-card">
          <a href="{{ article.url }}" class="blog-card__image-wrapper">
            {% if article.image %}
              <img
                src="{{ article.image | image_url: width: 720 }}"
                srcset="
                  {{ article.image | image_url: width: 360 }} 360w,
                  {{ article.image | image_url: width: 540 }} 540w,
                  {{ article.image | image_url: width: 720 }} 720w,
                  {{ article.image | image_url: width: 1080 }} 1080w
                "
                sizes="(max-width: 767px) 100vw, 50vw"
                alt="{{ article.image.alt | escape }}"
                loading="lazy"
                width="{{ article.image.width }}"
                height="{{ article.image.height }}"
              >
            {% else %}
              <div class="blog-card__image-placeholder">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
              </div>
            {% endif %}

            {% if article.tags.size > 0 %}
              <span class="blog-card__tag">{{ article.tags.first }}</span>
            {% endif %}
          </a>

          <div class="blog-card__content">
            {% if section.settings.show_date or section.settings.show_author %}
              <div class="blog-card__meta">
                {% if section.settings.show_date and section.settings.show_author %}
                  {{ 'blog.article_metadata_html' | t: date: article.published_at | date: "%B %d, %Y", author: article.author }}
                {% elsif section.settings.show_date %}
                  {{ article.published_at | date: "%B %d, %Y" }}
                {% elsif section.settings.show_author %}
                  {{ article.author }}
                {% endif %}
              </div>
            {% endif %}

            <h2 class="blog-card__title">
              <a href="{{ article.url }}">{{ article.title }}</a>
            </h2>

            {% if section.settings.show_excerpt and article.excerpt_or_content != blank %}
              <p class="blog-card__excerpt">{{ article.excerpt_or_content | strip_html | truncatewords: 25 }}</p>
            {% endif %}

            <a href="{{ article.url }}" class="blog-card__read-more">
              {{ 'blog.read_more' | t }}
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
            </a>
          </div>
        </article>
      {% endfor %}
    </div>

    {% if paginate.pages > 1 %}
      <nav class="blog-pagination" aria-label="Pagination">
        {% if paginate.previous %}
          <a href="{{ paginate.previous.url }}" class="blog-pagination__btn blog-pagination__prev" aria-label="Previous page">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
          </a>
        {% else %}
          <span class="blog-pagination__btn blog-pagination__prev disabled" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
          </span>
        {% endif %}

        <div class="blog-pagination__numbers">
          {% for part in paginate.parts %}
            {% if part.is_link %}
              <a href="{{ part.url }}" class="blog-pagination__number">{{ part.title }}</a>
            {% else %}
              {% if part.title == paginate.current_page %}
                <span class="blog-pagination__number active" aria-current="page">{{ part.title }}</span>
              {% else %}
                <span class="blog-pagination__number gap">{{ part.title }}</span>
              {% endif %}
            {% endif %}
          {% endfor %}
        </div>

        {% if paginate.next %}
          <a href="{{ paginate.next.url }}" class="blog-pagination__btn blog-pagination__next" aria-label="Next page">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
          </a>
        {% else %}
          <span class="blog-pagination__btn blog-pagination__next disabled" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"/></svg>
          </span>
        {% endif %}
      </nav>
    {% endif %}

  {% else %}
    <div class="blog-empty">
      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
      <p>{{ 'blog.no_articles' | t }}</p>
    </div>
  {% endif %}
</div>

{% endpaginate %}

{% stylesheet %}
.blog-section {
  max-width: var(--page-width, 1200px);
  margin: 0 auto;
  padding: 60px var(--page-margin, 20px) 80px;
  font-family: var(--font-primary--family, sans-serif);
  color: var(--color-foreground, #1a1a1a);
}

/* ── Header ── */
.blog-header {
  text-align: center;
  margin-bottom: 48px;
}

.blog-title {
  font-size: clamp(2rem, 5vw, 3rem);
  font-weight: 700;
  letter-spacing: -0.02em;
  margin: 0 0 24px;
  color: var(--color-foreground, #1a1a1a);
}

/* ── Tag Pills ── */
.blog-tags {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 8px;
}

.blog-tag-pill {
  display: inline-block;
  padding: 6px 18px;
  border-radius: 999px;
  font-size: 0.85rem;
  font-weight: 500;
  text-decoration: none;
  border: 1.5px solid var(--color-primary, #c28946);
  color: var(--color-primary, #c28946);
  background: transparent;
  transition: background 0.25s ease, color 0.25s ease, box-shadow 0.25s ease;
}

.blog-tag-pill:hover {
  background: var(--color-primary, #c28946);
  color: var(--color-button-label, #fff);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.blog-tag-pill.active {
  background: var(--color-primary, #c28946);
  color: var(--color-button-label, #fff);
}

/* ── Grid ── */
.blog-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 32px;
}

@media (max-width: 767px) {
  .blog-grid {
    grid-template-columns: 1fr;
    gap: 24px;
  }
}

/* ── Card ── */
.blog-card {
  background: var(--color-background, #fff);
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06), 0 4px 16px rgba(0, 0, 0, 0.04);
  transition: transform 0.35s ease, box-shadow 0.35s ease;
  display: flex;
  flex-direction: column;
}

.blog-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
}

/* ── Card Image ── */
.blog-card__image-wrapper {
  position: relative;
  display: block;
  aspect-ratio: 3 / 2;
  overflow: hidden;
  background: var(--color-secondary, #f5f5f5);
}

.blog-card__image-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.blog-card:hover .blog-card__image-wrapper img {
  transform: scale(1.05);
}

.blog-card__image-placeholder {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--color-primary, #c28946);
  opacity: 0.35;
}

.blog-card__image-placeholder svg {
  width: 48px;
  height: 48px;
}

.blog-card__tag {
  position: absolute;
  top: 12px;
  left: 12px;
  padding: 4px 12px;
  font-size: 0.7rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  background: var(--color-primary, #c28946);
  color: var(--color-button-label, #fff);
  border-radius: 4px;
  line-height: 1.4;
}

/* ── Card Content ── */
.blog-card__content {
  padding: 24px;
  display: flex;
  flex-direction: column;
  flex-grow: 1;
}

.blog-card__meta {
  font-size: 0.8rem;
  color: var(--color-foreground, #1a1a1a);
  opacity: 0.5;
  margin-bottom: 8px;
  line-height: 1.4;
}

.blog-card__title {
  font-size: 1.2rem;
  font-weight: 600;
  line-height: 1.35;
  margin: 0 0 12px;
}

.blog-card__title a {
  color: var(--color-foreground, #1a1a1a);
  text-decoration: none;
  transition: color 0.25s ease;
}

.blog-card__title a:hover {
  color: var(--color-primary, #c28946);
}

.blog-card__excerpt {
  font-size: 0.92rem;
  line-height: 1.6;
  color: var(--color-foreground, #1a1a1a);
  opacity: 0.7;
  margin: 0 0 16px;
  flex-grow: 1;
}

.blog-card__read-more {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 0.88rem;
  font-weight: 600;
  color: var(--color-primary, #c28946);
  text-decoration: none;
  transition: gap 0.25s ease;
  margin-top: auto;
}

.blog-card__read-more:hover {
  gap: 10px;
}

.blog-card__read-more svg {
  transition: transform 0.25s ease;
}

.blog-card__read-more:hover svg {
  transform: translateX(2px);
}

/* ── Pagination ── */
.blog-pagination {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  margin-top: 56px;
}

.blog-pagination__numbers {
  display: flex;
  align-items: center;
  gap: 4px;
}

.blog-pagination__btn,
.blog-pagination__number {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 40px;
  height: 40px;
  padding: 0 6px;
  border-radius: 8px;
  font-size: 0.9rem;
  font-weight: 500;
  text-decoration: none;
  color: var(--color-foreground, #1a1a1a);
  background: transparent;
  border: 1.5px solid transparent;
  transition: background 0.25s ease, border-color 0.25s ease, color 0.25s ease;
}

.blog-pagination__btn:hover,
.blog-pagination__number:hover {
  background: var(--color-secondary, #f5f5f5);
}

.blog-pagination__number.active {
  background: var(--color-primary, #c28946);
  color: var(--color-button-label, #fff);
  border-color: var(--color-primary, #c28946);
}

.blog-pagination__number.gap {
  pointer-events: none;
  opacity: 0.4;
}

.blog-pagination__btn.disabled {
  opacity: 0.25;
  pointer-events: none;
}

/* ── Empty State ── */
.blog-empty {
  text-align: center;
  padding: 80px 20px;
  color: var(--color-foreground, #1a1a1a);
  opacity: 0.45;
}

.blog-empty svg {
  margin-bottom: 16px;
}

.blog-empty p {
  font-size: 1.1rem;
  margin: 0;
}
{% endstylesheet %}

{% schema %}
{
  "name": "Blog",
  "tag": "section",
  "class": "section-blog",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_breadcrumbs",
      "label": "Show breadcrumbs",
      "default": true
    },
    {
      "type": "range",
      "id": "articles_per_page",
      "label": "Articles per page",
      "min": 3,
      "max": 12,
      "step": 1,
      "default": 6
    },
    {
      "type": "checkbox",
      "id": "show_tags",
      "label": "Show tag filter",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_author",
      "label": "Show author",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_date",
      "label": "Show date",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_excerpt",
      "label": "Show excerpt",
      "default": true
    }
  ]
}
{% endschema %}

{%- comment -%}
  Contact section — two-column layout.
  Left: Shopify contact form (sends to store email).
  Right: editable info blocks (heading, text, icon + text).
{%- endcomment -%}

<section class="ct-section" style="
  --ct-accent: {{ section.settings.accent_color }};
  --ct-btn-bg: {{ section.settings.button_color }};
  --ct-btn-text: {{ section.settings.button_text_color }};
  --ct-input-bg: {{ section.settings.input_bg_color }};
  --ct-input-border: {{ section.settings.input_border_color }};
  --ct-heading-color: {{ section.settings.heading_color }};
  --ct-text-color: {{ section.settings.text_color }};
  padding-top: {{ section.settings.padding_top }}px;
  padding-bottom: {{ section.settings.padding_bottom }}px;
">
  <div class="ct-container">

    {%- comment -%} === SECTION HEADING === {%- endcomment -%}
    {% if section.settings.section_heading != blank %}
      <h1 class="ct-section-heading">{{ section.settings.section_heading }}</h1>
    {% endif %}

    <div class="ct-grid">

      {%- comment -%} ===== LEFT COLUMN — FORM ===== {%- endcomment -%}
      <div class="ct-form-col">
        {% form 'contact', id: 'ContactForm' %}

          {% if form.posted_successfully? %}
            <script>
              document.addEventListener('DOMContentLoaded', function () {
                var popup = document.getElementById('ctThankYouPopup');
                if (popup) { popup.classList.add('ct-popup--visible'); }
              });
            </script>
          {% endif %}

          {% if form.errors %}
            <div class="ct-form-errors" role="alert">
              <p><strong>{{ form.errors | default_errors }}</strong></p>
            </div>
          {% endif %}

          <div class="ct-form-row ct-form-row--2col">
            <div class="ct-field">
              <label class="ct-label" for="ct-name">Name</label>
              <input
                type="text"
                id="ct-name"
                name="contact[name]"
                class="ct-input"
                placeholder="Name"
                value="{{ form.name }}"
              >
            </div>
            <div class="ct-field">
              <label class="ct-label" for="ct-email">Email <span class="ct-required">*</span></label>
              <input
                type="email"
                id="ct-email"
                name="contact[email]"
                class="ct-input"
                placeholder="Email"
                required
                autocomplete="email"
                value="{{ form.email }}"
              >
            </div>
          </div>

          <div class="ct-form-row ct-form-row--2col">
            <div class="ct-field">
              <label class="ct-label" for="ct-phone">Phone Number <span class="ct-required">*</span></label>
              <input
                type="tel"
                id="ct-phone"
                name="contact[phone]"
                class="ct-input"
                placeholder="Phone Number"
                required
                value="{{ form.phone }}"
              >
            </div>
            <div class="ct-field">
              <label class="ct-label" for="ct-order">Order Number</label>
              <input
                type="text"
                id="ct-order"
                name="contact[order_number]"
                class="ct-input"
                placeholder="Order Number"
              >
            </div>
          </div>

          {% if section.settings.show_state_field %}
            <div class="ct-form-row">
              <div class="ct-field">
                <label class="ct-label" for="ct-state">State</label>
                <select id="ct-state" name="contact[state]" class="ct-input ct-select">
                  <option value="" disabled selected>Select</option>
                  {% assign states = section.settings.state_options | split: ',' %}
                  {% for state in states %}
                    <option value="{{ state | strip }}">{{ state | strip }}</option>
                  {% endfor %}
                </select>
              </div>
            </div>
          {% endif %}

          <div class="ct-form-row">
            <div class="ct-field">
              <label class="ct-label" for="ct-message">Your message</label>
              <textarea
                id="ct-message"
                name="contact[body]"
                class="ct-input ct-textarea"
                placeholder="Your message"
                rows="6"
              >{{ form.body }}</textarea>
            </div>
          </div>

          <div class="ct-form-row">
            <button type="submit" class="ct-submit-btn">
              {{ section.settings.button_text }}
            </button>
          </div>

        {% endform %}
      </div>

      {%- comment -%} ===== RIGHT COLUMN — INFO BLOCKS ===== {%- endcomment -%}
      <div class="ct-info-col">
        {% for block in section.blocks %}
          <div class="ct-info-block ct-info-block--{{ block.type }}" {{ block.shopify_attributes }}>

            {% case block.type %}

              {% when 'heading' %}
                <{{ block.settings.heading_tag }} class="ct-info-heading" style="font-size: {{ block.settings.heading_size }}px;">
                  {{ block.settings.heading }}
                </{{ block.settings.heading_tag }}>

              {% when 'text' %}
                <div class="ct-info-text">{{ block.settings.text }}</div>

              {% when 'icon_text' %}
                <div class="ct-icon-row">
                  <div class="ct-icon-circle">
                    {% if block.settings.custom_icon %}
                      <img
                        src="{{ block.settings.custom_icon | image_url: width: 80 }}"
                        alt="{{ block.settings.text | escape }}"
                        width="40"
                        height="40"
                        loading="lazy"
                      >
                    {% else %}
                      {% case block.settings.icon %}
                        {% when 'location' %}
                          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
                        {% when 'phone' %}
                          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                        {% when 'email' %}
                          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                        {% when 'clock' %}
                          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                        {% when 'globe' %}
                          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                        {% when 'chat' %}
                          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
                      {% endcase %}
                    {% endif %}
                  </div>
                  <div class="ct-icon-content">
                    {% if block.settings.label != blank %}
                      <strong class="ct-icon-label">{{ block.settings.label }}</strong>
                    {% endif %}
                    <span class="ct-icon-text">{{ block.settings.text }}</span>
                  </div>
                </div>

            {% endcase %}

          </div>
        {% endfor %}
      </div>

    </div>
  </div>

  {%- comment -%} ===== THANK YOU POPUP ===== {%- endcomment -%}
  <div class="ct-popup-overlay" id="ctThankYouPopup">
    <div class="ct-popup">
      <button class="ct-popup-close" id="ctPopupClose" aria-label="Close">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
      </button>
      <div class="ct-popup-icon">
        <svg width="56" height="56" viewBox="0 0 24 24" fill="none" stroke="var(--ct-accent)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
          <polyline points="22 4 12 14.01 9 11.01"/>
        </svg>
      </div>
      <h2 class="ct-popup-title">{{ section.settings.popup_heading }}</h2>
      <p class="ct-popup-text">{{ section.settings.popup_text }}</p>
      <button class="ct-popup-btn" id="ctPopupOk">OK</button>
    </div>
  </div>

</section>

{%- comment -%} ============================================================
     JAVASCRIPT
     ============================================================ {%- endcomment -%}
<script>
document.addEventListener('DOMContentLoaded', function () {
  var overlay = document.getElementById('ctThankYouPopup');
  var closeBtn = document.getElementById('ctPopupClose');
  var okBtn = document.getElementById('ctPopupOk');

  function closePopup() {
    if (overlay) overlay.classList.remove('ct-popup--visible');
  }

  if (closeBtn) closeBtn.addEventListener('click', closePopup);
  if (okBtn) okBtn.addEventListener('click', closePopup);
  if (overlay) {
    overlay.addEventListener('click', function (e) {
      if (e.target === overlay) closePopup();
    });
  }
});
</script>

{%- comment -%} ============================================================
     STYLES
     ============================================================ {%- endcomment -%}
<style>
  /* ========== SECTION ========== */
  .ct-section {
    font-family: inherit;
    color: var(--ct-text-color);
  }

  .ct-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .ct-section-heading {
    font-size: 36px;
    font-weight: 700;
    color: var(--ct-heading-color);
    margin: 0 0 40px;
    line-height: 1.2;
  }

  /* ========== GRID ========== */
  .ct-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 60px;
    align-items: start;
  }

  /* ========== FORM COLUMN ========== */
  .ct-form-col {
    min-width: 0;
  }

  .ct-form-errors {
    background: #fef2f2;
    border: 1px solid #fecaca;
    color: #991b1b;
    padding: 12px 16px;
    border-radius: 10px;
    margin-bottom: 20px;
    font-size: 14px;
  }
  .ct-form-errors p { margin: 0; }

  .ct-form-row {
    margin-bottom: 20px;
  }

  .ct-form-row--2col {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
  }

  .ct-label {
    display: block;
    font-size: 14px;
    font-weight: 600;
    color: var(--ct-heading-color);
    margin-bottom: 8px;
  }

  .ct-required {
    color: #e53e3e;
  }

  .ct-input {
    width: 100%;
    padding: 14px 18px;
    background: var(--ct-input-bg);
    border: 1px solid var(--ct-input-border);
    border-radius: 10px;
    font-size: 15px;
    font-family: inherit;
    color: var(--ct-text-color);
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
    outline: none;
    box-sizing: border-box;
  }

  .ct-input::placeholder {
    color: #999;
  }

  .ct-input:focus {
    border-color: var(--ct-accent);
    box-shadow: 0 0 0 3px color-mix(in srgb, var(--ct-accent) 15%, transparent);
  }

  .ct-select {
    appearance: none;
    cursor: pointer;
    background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%23666' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 16px center;
    padding-right: 44px;
  }

  .ct-textarea {
    resize: vertical;
    min-height: 140px;
  }

  .ct-submit-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 16px 40px;
    background: var(--ct-btn-bg);
    color: var(--ct-btn-text);
    border: none;
    border-radius: 30px;
    font-size: 15px;
    font-weight: 700;
    font-family: inherit;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
    letter-spacing: 0.03em;
  }

  .ct-submit-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px color-mix(in srgb, var(--ct-btn-bg) 35%, transparent);
  }

  .ct-submit-btn:active {
    transform: translateY(0);
  }

  /* ========== INFO COLUMN ========== */
  .ct-info-col {
    padding: 32px 36px;
    border-left: 1px solid color-mix(in srgb, var(--ct-text-color) 10%, transparent);
  }

  .ct-info-block {
    margin-bottom: 28px;
  }
  .ct-info-block:last-child {
    margin-bottom: 0;
  }

  /* -- Heading block -- */
  .ct-info-heading {
    font-weight: 700;
    color: var(--ct-heading-color);
    margin: 0 0 16px;
    line-height: 1.3;
  }

  /* -- Text block -- */
  .ct-info-text {
    font-size: 15px;
    line-height: 1.7;
    color: var(--ct-text-color);
    opacity: 0.8;
  }
  .ct-info-text p { margin: 0 0 10px; }
  .ct-info-text p:last-child { margin-bottom: 0; }

  /* -- Icon + text block -- */
  .ct-icon-row {
    display: flex;
    align-items: flex-start;
    gap: 16px;
  }

  .ct-icon-circle {
    flex-shrink: 0;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: color-mix(in srgb, var(--ct-accent) 12%, transparent);
    color: var(--ct-accent);
  }

  .ct-icon-circle img {
    width: 24px;
    height: 24px;
    object-fit: contain;
  }

  .ct-icon-content {
    display: flex;
    flex-direction: column;
    gap: 2px;
    padding-top: 4px;
  }

  .ct-icon-label {
    font-size: 15px;
    font-weight: 600;
    color: var(--ct-heading-color);
    line-height: 1.3;
  }

  .ct-icon-text {
    font-size: 14px;
    line-height: 1.6;
    color: var(--ct-text-color);
    opacity: 0.75;
  }

  /* ========== THANK YOU POPUP ========== */
  .ct-popup-overlay {
    position: fixed;
    inset: 0;
    z-index: 9999;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }

  .ct-popup-overlay.ct-popup--visible {
    opacity: 1;
    visibility: visible;
  }

  .ct-popup {
    background: #fff;
    border-radius: 24px;
    padding: 48px 40px 40px;
    max-width: 420px;
    width: 90%;
    text-align: center;
    position: relative;
    box-shadow: 0 25px 60px rgba(0, 0, 0, 0.2);
    transform: scale(0.9) translateY(20px);
    transition: transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .ct-popup--visible .ct-popup {
    transform: scale(1) translateY(0);
  }

  .ct-popup-close {
    position: absolute;
    top: 16px;
    right: 16px;
    background: none;
    border: none;
    color: #999;
    cursor: pointer;
    padding: 4px;
    border-radius: 50%;
    transition: color 0.2s ease, background 0.2s ease;
  }

  .ct-popup-close:hover {
    color: #333;
    background: #f3f3f3;
  }

  .ct-popup-icon {
    margin-bottom: 20px;
  }

  .ct-popup-title {
    font-size: 24px;
    font-weight: 700;
    color: #1a1a1a;
    margin: 0 0 10px;
  }

  .ct-popup-text {
    font-size: 15px;
    color: #666;
    line-height: 1.6;
    margin: 0 0 28px;
  }

  .ct-popup-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 14px 48px;
    background: var(--ct-accent);
    color: #fff;
    border: none;
    border-radius: 30px;
    font-size: 15px;
    font-weight: 700;
    font-family: inherit;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .ct-popup-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px color-mix(in srgb, var(--ct-accent) 35%, transparent);
  }

  /* ========== RESPONSIVE ========== */
  @media screen and (max-width: 990px) {
    .ct-grid {
      grid-template-columns: 1fr;
      gap: 40px;
    }

    .ct-info-col {
      border-left: none;
      border-top: 1px solid color-mix(in srgb, var(--ct-text-color) 10%, transparent);
      padding: 32px 0 0;
    }
  }

  @media screen and (max-width: 480px) {
    .ct-section-heading {
      font-size: 28px;
      margin-bottom: 28px;
    }

    .ct-form-row--2col {
      grid-template-columns: 1fr;
    }

    .ct-container {
      padding: 0 16px;
    }

    .ct-popup {
      padding: 36px 24px 32px;
    }

    .ct-popup-title {
      font-size: 20px;
    }
  }
</style>

{% schema %}
{
  "name": "Contact Form",
  "tag": "section",
  "class": "section-contact",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "section_heading",
      "label": "Section heading",
      "default": "Contact"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Submit button text",
      "default": "Submit Now"
    },
    {
      "type": "header",
      "content": "State field"
    },
    {
      "type": "checkbox",
      "id": "show_state_field",
      "label": "Show state/region dropdown",
      "default": true
    },
    {
      "type": "textarea",
      "id": "state_options",
      "label": "State options (comma-separated)",
      "default": "Andhra Pradesh, Arunachal Pradesh, Assam, Bihar, Chhattisgarh, Goa, Gujarat, Haryana, Himachal Pradesh, Jharkhand, Karnataka, Kerala, Madhya Pradesh, Maharashtra, Manipur, Meghalaya, Mizoram, Nagaland, Odisha, Punjab, Rajasthan, Sikkim, Tamil Nadu, Telangana, Tripura, Uttar Pradesh, Uttarakhand, West Bengal"
    },
    {
      "type": "header",
      "content": "Thank you popup"
    },
    {
      "type": "text",
      "id": "popup_heading",
      "label": "Popup heading",
      "default": "Thank You!"
    },
    {
      "type": "textarea",
      "id": "popup_text",
      "label": "Popup message",
      "default": "Your message has been sent successfully. We'll get back to you as soon as possible."
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent color",
      "default": "#4a9e7d"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#1a1a1a"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#444444"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button background",
      "default": "#c28946"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "input_bg_color",
      "label": "Input background",
      "default": "#f3f3f3"
    },
    {
      "type": "color",
      "id": "input_border_color",
      "label": "Input border",
      "default": "#e8e8e8"
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding top",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding bottom",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "default": 60
    }
  ],
  "blocks": [
    {
      "type": "heading",
      "name": "Heading",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading text",
          "default": "Arismeta Tech Pvt Ltd"
        },
        {
          "type": "select",
          "id": "heading_tag",
          "label": "Heading level",
          "options": [
            { "value": "h2", "label": "H2" },
            { "value": "h3", "label": "H3" },
            { "value": "h4", "label": "H4" }
          ],
          "default": "h2"
        },
        {
          "type": "range",
          "id": "heading_size",
          "label": "Font size",
          "min": 16,
          "max": 48,
          "step": 1,
          "unit": "px",
          "default": 28
        }
      ]
    },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "label": "Text content",
          "default": "<p>To us, quality has a broader purpose and as you can read about on this website, we are on a mission.</p>"
        }
      ]
    },
    {
      "type": "icon_text",
      "name": "Icon + Text",
      "settings": [
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "options": [
            { "value": "location", "label": "Location pin" },
            { "value": "phone", "label": "Phone" },
            { "value": "email", "label": "Email" },
            { "value": "clock", "label": "Clock" },
            { "value": "globe", "label": "Globe" },
            { "value": "chat", "label": "Chat" }
          ],
          "default": "location"
        },
        {
          "type": "image_picker",
          "id": "custom_icon",
          "label": "Custom icon image",
          "info": "Overrides the selected icon above"
        },
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "General Office"
        },
        {
          "type": "textarea",
          "id": "text",
          "label": "Text",
          "default": "Bengaluru, Karnataka 560058"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Contact Form",
      "blocks": [
        {
          "type": "heading",
          "settings": {
            "heading": "Arismeta tech Private Limited"
          }
        },
        {
          "type": "text",
          "settings": {
            "text": "<p>To us, quality has a broader purpose and as you can read about on this website, we are on a mission.</p>"
          }
        },
        {
          "type": "icon_text",
          "settings": {
            "icon": "location",
            "label": "General Office",
            "text": " Bengaluru, Karnataka 560058"
          }
        },
        {
          "type": "icon_text",
          "settings": {
            "icon": "phone",
            "label": "",
            "text": "+91-900000000"
          }
        },
        {
          "type": "icon_text",
          "settings": {
            "icon": "email",
            "label": "",
            "text": "123@gmail.com"
          }
        }
      ]
    }
  ]
}
{% endschema %}
